<div ng-init="setPerm(['KOORD','TRENER', 'ZAWODNIK','STAFF'])"></div>
<div class="section" ng-init="getLastPost()">
    <div ng-show='showContent' class="row">
        <div class="col s12 m4 noPrint">
            <div class="card">
                <div class="card-content">
                    <div class="card-title">
                        Dodawanie nowego wpisu
                    </div>
                    <div class="row">
                        <div class="col s12">
                            <textarea onkeydown="if (event.keyCode == 13) document.getElementById('sendIt').click()" id="newPostInput" id="newPostInput" style='min-height: 1rem; height: 1rem;' name="Podaj treść" placeholder="Podaj treść" required class="materialize-textarea"></textarea>
                        </div>
                        <div class="col s12">
                            <button class="btn  btn-success " ng-click="addPost()"><i class="fa fa-paper-plane" aria-hidden="true"></i>Dodaj post</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col s12 m8">
            <div class="card" style="text-align: left;" ng-repeat="ps in posts |orderBy: '-date_add' | limitTo: maxPost">
                <div class="card-content">
                    <div class="card-title">
                        <div class="row">
                            <div class="col s12">
                                <div style="width: 60px; height: 60px; float: left;">
                                    <img src="{{ps.user_img_path}}" class="circle" width="60" height="60">
                                </div>
                                <div style="float: left; text-align: left; margin-left:10px; margin-top: 11px;">
                                    <p style="font-weight: bold; font-size: 17px; line-height:1.3;">{{ps.firstname}} {{ps.lastname}}</p>
                                    <p style="font-size: 13px; line-height:1;">{{ps.date_add}} </p>
                                </div>
                                <div style="float:right;">
                                    <div style="position: absolute; top: 5px; right: 15px; color: white; font-size: 20px; cursor: pointer" ng-show="user.id == ps.usid ">
                                        <i class="fa fa-times" aria-hidden="true" ng-click="deletePost(ps.psid)"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row" style="margin-top: 20px;">
                        <div class="col 12">
                            <p style=" font-size: 15px; font-family: 'Roboto'; padding: 0 30px">{{ps.content}}</p>
                        </div>
                    </div>

                    <div class="row" style="margin-top: 20px;">
                        <div class="col s12" style="padding: 0 10px;">
                            <div class="input-field col s12">
                                <textarea onkeydown="if (event.keyCode == 13) document.getElementById('sendIt').click()" id="tx_{{ps.psid}}" id="newPostInput" style='min-height: 1rem; height: 1rem;' name="newComment" placeholder="Skomentuj post" required class="materialize-textarea"
                                    data-length="120"></textarea>
                            </div>
                            <button hidden id='sendIt' ng-click="addComment(ps.psid)">
                            </button>
                        </div>
                    </div>
                    <div class="row" style="margin-top: 20px;">
                        <ul class="collection col s12">
                            <li ng-repeat="cm in ps.comments | limitTo: ps.maxComment" class="collection-item avatar">
                                <img src="{{cm.user_img_path}}" alt="" class="circle">
                                <span class="title">{{cm.firstname}} {{cm.lastname}}</span>
                                <p>{{cm.content}} <br> {{cm.date_add}}
                                </p>
                                <a ng-show="cm.usid == user.id" href="" ng-click="deleteComment(cm.cmid)" class="secondary-content"><i class="fa fa-times" aria-hidden="true" ></i></a>
                            </li>
                        </ul>
                        <a href='' class='col s12' ng-click="moreComment( ps.psid );" style="text-align:center; width: 100%; display:block;">Pokaż wcześniejsze komentarze</a>
                    </div>
                </div>
            </div>
            <a href='' class='col s12' ng-click="morePost( );" style="text-align:center; width: 100%; display:block;">Wyświetl więcej postów</a>
        </div>
    </div>
    <div ng-hide='showContent' style="position:relative; margin-top:15%; width: 60%; margin-left: auto; margin-right: auto;">
        <h3 style='text-align:center;'>Wczytywanie zawartości...</h3>
        <div class="preloader-wrapper big active" style="margin-left: 45%">
            <div class="spinner-layer spinner-blue">
                <div class="circle-clipper left">
                    <div class="circle"></div>
                </div>
                <div class="gap-patch">
                    <div class="circle"></div>
                </div>
                <div class="circle-clipper right">
                    <div class="circle"></div>
                </div>
            </div>
        </div>
    </div>
</div>